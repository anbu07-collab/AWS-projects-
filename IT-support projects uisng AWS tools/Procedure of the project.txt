GOAL

User submits a ticket â†’ Lambda adds it to DynamoDB â†’ SNS sends email alert â†’ you see record + mail.

Weâ€™ll build:

DynamoDB Table â€“ stores tickets

SNS Topic â€“ sends notifications

IAM Role â€“ gives permissions to Lambda

Lambda Function â€“ main logic

(Later): API Gateway + S3 frontend

ğŸªŸ STEP 1 â€” Create DynamoDB Table

Purpose: Store tickets like (ticketId, userId, issue, priority, status, etc.)

Steps

Go to AWS Console â†’ search bar â†’ type DynamoDB â†’ open it.

Click Create table.

Fill in:

Table name: ITSupportTickets

Partition key: ticketId â†’ Type = String

Scroll down â†’ Table settings â†’ choose Default settings (recommended).

Billing mode = On-demand (no need to set capacity).

Click Create table.

âœ… Check: After a few seconds, youâ€™ll see â€œActiveâ€ status.
That means your table is ready to store data.

ğŸ“£ STEP 2 â€” Create SNS Topic & Email Subscription

Purpose: Notify IT team instantly when a ticket is logged.

Steps

AWS Console â†’ search SNS â†’ open Simple Notification Service.

In the left menu â†’ click Topics â†’ Create topic.

Choose:

Type: Standard

Name: IT-Support-Alerts

Click Create topic.

Now youâ€™ll see your new topic. Copy its Topic ARN (looks like arn:aws:sns:us-east-1:123456789012:IT-Support-Alerts) â€” youâ€™ll need it later.

Add email subscription

While inside your topic, click Create subscription.

Protocol: Email
Endpoint: your actual email address (e.g., yourname@gmail.com)

Click Create subscription.

Now go to your email inbox â†’ open the email from AWS â†’ click Confirm subscription link.

âœ… Check: Back in SNS Console â†’ refresh the page. It should show Status: Confirmed.

ğŸ” STEP 3 â€” Create IAM Role for Lambda

Purpose: Gives your Lambda permission to:

Write to DynamoDB

Publish to SNS

Write logs in CloudWatch

Steps

AWS Console â†’ search IAM â†’ open IAM service.

In the left menu â†’ click Roles â†’ Create role.

Choose:

Trusted entity type: AWS service

Use case: Lambda

Click Next.

Attach permissions (search and select these one by one):

âœ… AmazonDynamoDBFullAccess

âœ… AmazonSNSFullAccess

âœ… CloudWatchFullAccess

âœ… AWSLambdaBasicExecutionRole (for writing logs)

Click Next.

Role name: lambda-it-ticket-role

Click Create role.

âœ… Check: You should now see lambda-it-ticket-role in your role list.

ğŸ§  STEP 4 â€” Create Lambda Function

Purpose: This function handles ticket creation and sends alerts.

Steps

AWS Console â†’ search Lambda â†’ open it.

Click Create function.

Choose:

Author from scratch

Function name: CreateTicketFunction

Runtime: Python 3.11 (or 3.10 if not available)

Permissions:
Choose Use an existing role â†’ pick lambda-it-ticket-role.

Click Create function.

âœ… Lambda function created!

âš™ï¸ STEP 5 â€” Add Environment Variables

Weâ€™ll tell Lambda which DynamoDB table and SNS topic to use.

In your Lambda page â†’ click Configuration tab.

On the left â†’ click Environment variables â†’ Edit â†’ Add environment variable.

Key = TICKETS_TABLE
Value = ITSupportTickets

Key = SNS_TOPIC_ARN
Value = (paste your topic ARN from SNS)

Click Save.

ğŸ’» STEP 6 â€” Add Lambda Code
Steps

Click Code tab at the top.

Delete the default code.

Copyâ€“paste this code inside the editor:
_____________________________________________________________________
import json
import os
import uuid
from datetime import datetime
import boto3

dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table(os.environ['TICKETS_TABLE'])
sns = boto3.client('sns')
SNS_TOPIC_ARN = os.environ['SNS_TOPIC_ARN']

def lambda_handler(event, context):
    # event may come from API Gateway or test input
    body = event.get('body', event)
    if isinstance(body, str):
        try:
            body = json.loads(body)
        except Exception:
            return {"statusCode":400, "body": json.dumps({"message":"Invalid JSON"})}

    # basic required fields
    for field in ['userId','subject','description','priority']:
        if field not in body:
            return {"statusCode":400, "body": json.dumps({"message":f"Missing field: {field}"})}

    ticket_id = str(uuid.uuid4())
    now = datetime.utcnow().isoformat() + "Z"

    item = {
        'ticketId': ticket_id,
        'userId': body['userId'],
        'subject': body['subject'],
        'description': body['description'],
        'priority': body['priority'],
        'status': 'OPEN',
        'createdAt': now
    }

    # write to DynamoDB
    table.put_item(Item=item)

    # publish notification to SNS
    sns.publish(
        TopicArn=SNS_TOPIC_ARN,
        Subject="New IT Ticket Created",
        Message=f"Ticket {ticket_id}: {body['subject']} (Priority: {body['priority']})"
    )

    return {"statusCode":201, "body": json.dumps({"ticketId": ticket_id})}
_______________________________________________________________________________

Click Deploy (top-right corner).

âœ… Function is ready.

ğŸ§ª STEP 7 â€” Test Lambda

Weâ€™ll simulate a ticket submission.

In Lambda â†’ top bar â†’ click Test.

Create new test event:

Name: create-ticket-test

Event JSON:

{
  "body": "{\"userId\":\"U001\",\"subject\":\"Printer not working\",\"description\":\"Office printer is offline\",\"priority\":\"HIGH\"}"
}


Click Save, then Test.

âœ… Result:

It should show statusCode: 201.

Youâ€™ll see a generated ticketId.

ğŸ“‹ STEP 8 â€” Verify Results
DynamoDB

Go to DynamoDB â†’ Tables â†’ ITSupportTickets.

Click Explore table items.

You should see your new ticket (with ticketId, subject, etc.).

SNS Email

Check your inbox (the one you subscribed).

You should have an email titled â€œNew IT Ticket Createdâ€ with details.

CloudWatch Logs (Optional)

AWS Console â†’ search CloudWatch â†’ Logs â†’ Log groups.

Open /aws/lambda/CreateTicketFunction.

You can view print statements and errors if any.

âœ… DONE

Youâ€™ve built your first Serverless IT Ticket Notification System with:

Tier 1: (to come) frontend S3 form

Tier 2: Lambda logic

Tier 3: DynamoDB database

Tier 4: SNS alerts

Next Step (when youâ€™re ready):
ğŸ‘‰ Connect API Gateway to this Lambda so that users can submit tickets via a web form or Postman.
__

STEP 2 â€” Connect API Gateway to Lambda

Goal: Create a REST API endpoint like
https://abcd1234.execute-api.us-east-1.amazonaws.com/prod/tickets
When a user calls it with a POST request, API Gateway triggers your CreateTicketFunction.

ğŸ§© Part 1 â€” Create the API

In AWS Console â†’ search API Gateway â†’ open it.

Click Create API.

Choose REST API (the first card, not HTTP API) â†’ Build.

Settings:

API name: ITTicketAPI

Endpoint Type: Regional

Click Create API.

âœ… You now have an empty REST API.

ğŸ§­ Part 2 â€” Create a Resource (path)

Left panel â†’ click Resources.

Click Create Resource.

Resource name: tickets

Resource Path: /tickets

Leave â€œConfigure as proxyâ€ unchecked.

Click Create Resource.

âœ… You now have /tickets under your API.

âš™ï¸ Part 3 â€” Create POST Method and Connect to Lambda

Select /tickets â†’ click Create Method â†’ choose POST â†’ âœ”ï¸ checkmark.

Integration type: Lambda Function

Lambda Function: type CreateTicketFunction

Check the box Use Lambda proxy integration (important).

Click Save â†’ choose OK when asked for permissions.

âœ… API Gateway can now trigger your Lambda.

ğŸ§ª Part 4 â€” Deploy the API

In left menu â†’ click Actions â†’ Deploy API.

Create a new stage:

Stage name: prod

Description: Production stage

Click Deploy.

Youâ€™ll see a Invoke URL like:

https://abcd1234.execute-api.us-east-1.amazonaws.com/prod


âœ… Copy this URL â€” youâ€™ll use it for testing.

ğŸ§° Part 5 â€” Test the Endpoint

You can test in Postman or the built-in API Gateway Test.

Option 1: API Gateway Console Test

Under /tickets â†’ POST â†’ click Test (top-right).

Request Body:

{
  "userId": "U1001",
  "subject": "Laptop overheating",
  "description": "System shuts down after 5 minutes",
  "priority": "HIGH"
}


Click Test.
âœ… Response Code â†’ 201
âœ… Response Body â†’ {"ticketId": "uuid-value"}

Option 2: Postman

Method: POST

URL: https://abcd1234.execute-api.us-east-1.amazonaws.com/prod/tickets

Header: Content-Type: application/json

Body â†’ raw â†’ JSON:

{
  "userId": "U1001",
  "subject": "Laptop overheating",
  "description": "System shuts down after 5 minutes",
  "priority": "HIGH"
}


Click Send â†’ get 201 + ticketId.
Check your email and DynamoDB table again â€” both should reflect the new ticket.
_____


Youâ€™ll host a simple HTML + JavaScript form in Amazon S3, which directly calls your API Gateway â†’ Lambda â†’ DynamoDB + SNS.

ğŸ§± STEP 3 â€“ Create and Deploy the S3 Frontend (Ticket Submission Portal)
ğŸ¯ Goal

User opens a URL like:

https://it-support-portal.s3-website-us-east-1.amazonaws.com


Fills in a small form â†’ clicks Submit â†’ a new ticket is created â†’ IT team gets an email.

ğŸª£ PART 1 â€“ Create and Configure the S3 Bucket

In the AWS Console, search S3 â†’ open it.

Click Create bucket.

Fill in:

Bucket name: it-support-portal (must be globally unique)

Region: same as your API (for example, us-east-1)

Scroll down â†’ Block Public Access â†’ Uncheck â€œBlock all public access.â€
Confirm the warning checkbox.

Click Create bucket.

âœ… Bucket created.

Enable Static Website Hosting

Open your new bucket.

Go to Properties tab.

Scroll to Static website hosting â†’ click Edit.

Enable â†’ choose Host a static website.

Fill in:

Index document: index.html

Error document: index.html (optional)

Click Save changes.
Note the Bucket website endpoint â€“ thatâ€™s your frontend URL.

Make the Bucket Public (for the webpage only)

Go to Permissions tab â†’ Bucket policy â†’ Edit.

Paste this simple public-read policy (replace YOUR_BUCKET_NAME):

{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::YOUR_BUCKET_NAME/*"
    }
  ]
}


Save changes.

âœ… Now anything uploaded (like index.html) can be viewed by browser visitors.

ğŸ’» PART 2 â€“ Create the Frontend Code

Youâ€™ll make one file â†’ index.html
Open Notepad (or VS Code) and paste this:

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IT Service Ticket Portal</title>
  <style>
    body { font-family: Arial; margin: 40px; background: #f5f5f5; }
    h1 { color: #2d2d2d; }
    form { background: white; padding: 20px; border-radius: 10px; max-width: 400px; }
    input, textarea, select, button { width: 100%; margin: 8px 0; padding: 10px; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
    #msg { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>IT Support Ticket</h1>
  <form id="ticketForm">
    <label>User ID:</label>
    <input type="text" id="userId" required />
    <label>Subject:</label>
    <input type="text" id="subject" required />
    <label>Description:</label>
    <textarea id="description" rows="3" required></textarea>
    <label>Priority:</label>
    <select id="priority" required>
      <option value="LOW">LOW</option>
      <option value="MEDIUM">MEDIUM</option>
      <option value="HIGH">HIGH</option>
      <option value="URGENT">URGENT</option>
    </select>
    <button type="submit">Submit Ticket</button>
    <div id="msg"></div>
  </form>

  <script>
    const apiUrl = "https://YOUR_API_ID.execute-api.YOUR_REGION.amazonaws.com/prod/tickets";

    document.getElementById("ticketForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const msg = document.getElementById("msg");
      msg.textContent = "Submitting...";
      const data = {
        userId: document.getElementById("userId").value,
        subject: document.getElementById("subject").value,
        description: document.getElementById("description").value,
        priority: document.getElementById("priority").value,
      };
      try {
        const res = await fetch(apiUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });
        const json = await res.json();
        if (res.ok) {
          msg.style.color = "green";
          msg.textContent = "Ticket created! ID: " + json.ticketId;
        } else {
          msg.style.color = "red";
          msg.textContent = "Error: " + (json.message || "Unknown");
        }
      } catch (err) {
        msg.style.color = "red";
        msg.textContent = "Network error: " + err;
      }
    });
  </script>
</body>
</html>


ğŸŸ¡ Replace YOUR_API_ID and YOUR_REGION with your actual API Gateway URL parts,
for example:

https://abcd1234.execute-api.us-east-1.amazonaws.com/prod/tickets


Then save as index.html.

â˜ï¸ PART 3 â€“ Upload to S3

Open the bucket â†’ Objects tab â†’ Upload â†’ Add files â†’ choose index.html.

Click Upload.

When done, click the file name â†’ copy its Object URL.
OR use the Bucket website endpoint noted earlier.

âœ… Visit the URL in your browser â†’ youâ€™ll see your form.

ğŸ§ª PART 4 â€“ Test the Portal

Fill in User ID, Subject, Description, Priority.

Click Submit Ticket.

You should see:

Green success message with Ticket ID

Email notification in your IT team inbox

New record in DynamoDB â†’ ITSupportTickets â†’ Explore table items

"If you see a CORS error in browser console:
Go back to API Gateway â†’ /tickets â†’ Actions â†’ Enable CORS â†’ Deploy API again."